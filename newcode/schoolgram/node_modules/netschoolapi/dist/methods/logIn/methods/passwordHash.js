"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = default_1;
const iconv_lite_1 = require("iconv-lite");
const crypto_1 = require("crypto");
function md5(str) {
    const buf = (0, iconv_lite_1.encode)(str, "windows-1251");
    return (0, crypto_1.createHash)("md5").update(buf).digest("hex");
}
function default_1(salt, password) {
    const hash = typeof password === "string" ? md5(password) : password.hash;
    const pw2 = md5(salt + hash);
    const pw = pw2.substring(0, password.length);
    return { pw, pw2 };
}
//# sourceMappingURL=passwordHash.js.map